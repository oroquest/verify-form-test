<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Sikura – Adressbestätigung</title>
  <link rel="icon" href="data:,"/>
  <style>
    :root { --bg:#f5f6f8; --card:#fff; --muted:#6b7280; --border:#e5e7eb; --input:#d1d5db; --fg:#0f172a; --ok:#065f46; --err:#b91c1c; }
    body { font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; background:var(--bg); margin:0; color:#111827; }
    .container{ max-width:760px; margin:32px auto; background:var(--card); padding:24px; border-radius:14px; box-shadow:0 8px 24px rgba(0,0,0,.06); }
    .language-switcher{ display:flex; justify-content:flex-end; margin-bottom:8px; }
    .logo{ height:48px; margin-bottom:12px; }
    .hint{ color:var(--muted); font-size:14px; }
    .ctx{ background:#f9fafb; border:1px solid var(--border); padding:12px; border-radius:10px; margin:12px 0 16px; }
    label{ display:block; margin:12px 0 6px; font-weight:600; }
    input[type="text"]{ width:100%; padding:12px; border:1px solid var(--input); border-radius:10px; font-size:16px; background:#fff; }
    input[readonly]{ background:#f3f4f6; color:#6b7280; }
    .row{ display:flex; gap:16px; }
    .row > div{ flex:1; }
    .field-error{ color:var(--err); font-size:13px; margin-top:4px; display:none; }
    .error-field{ border-color:var(--err) !important; }
    .ok{ color:var(--ok); margin:10px 0; display:none; }
    .hidden{ display:none; }
    button{ margin-top:18px; padding:12px 18px; border:0; background:var(--fg); color:#fff; border-radius:10px; font-size:16px; cursor:pointer; }
    button:disabled{ opacity:.6; cursor:not-allowed; }
    .linkline{ margin-top:4px; }
    #gate-error{ padding:8px 12px; background:#fff1f2; border:1px solid #fecdd3; border-radius:10px; }
    .checkbox-line{ display:flex; gap:8px; align-items:flex-start; margin-top:8px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="language-switcher">
      <select id="language">
        <option value="de">Deutsch</option>
        <option value="it">Italiano</option>
        <option value="en">English</option>
      </select>
    </div>

    <img src="siku_logo.png" alt="Sikura Life" class="logo"/>
    <h2 id="title">Bitte bestätigen Sie Ihre Adresse</h2>
    <p id="intro" class="hint">Felder sind vorbefüllt und können bei Bedarf aktualisiert werden.</p>

    <div id="ctx-box" class="ctx"></div>

    <div id="gate-error" class="field-error hidden" role="alert" aria-live="polite"></div>
    <div id="gate-ok" class="ok hidden"></div>

    <form id="verify-form" class="hidden" method="POST" action="/.netlify/functions/verify_submit" novalidate>
      <!-- Hidden: email/lang/id/token/em -->
      <input type="hidden" id="email" name="email"/>
      <input type="hidden" id="lang"  name="lang"/>
      <input type="hidden" id="id"    name="id"/>
      <input type="hidden" id="token" name="token"/>
      <input type="hidden" id="em"    name="em"/>

      <label for="glaeubiger" id="lbl-glaeubiger">Gläubiger‑Nr.</label>
      <input type="text" id="glaeubiger" name="glaeubiger" readonly required/>
      <div class="field-error" id="err-glaeubiger"></div>

      <label for="firstname" id="lbl-firstname">Vorname</label>
      <input type="text" id="firstname" name="firstname" readonly required/>
      <div class="field-error" id="err-firstname"></div>

      <label for="name" id="lbl-name">Nachname</label>
      <input type="text" id="name" name="name" readonly required/>
      <div class="field-error" id="err-name"></div>

      <div class="row">
        <div>
          <label for="strasse" id="lbl-strasse">Strasse</label>
          <input type="text" id="strasse" name="strasse" required/>
          <div class="field-error" id="err-strasse"></div>
        </div>
        <div style="max-width:180px;">
          <label for="hausnummer" id="lbl-hausnummer">Nr.</label>
          <input type="text" id="hausnummer" name="hausnummer" required/>
          <div class="field-error" id="err-hausnummer"></div>
        </div>
      </div>

      <div class="row">
        <div style="max-width:200px;">
          <label for="plz" id="lbl-plz">PLZ</label>
          <input type="text" id="plz" name="plz" required inputmode="numeric" pattern="\d*" autocomplete="postal-code"/>
          <div class="field-error" id="err-plz"></div>
        </div>
        <div>
          <label for="ort" id="lbl-ort">Ort</label>
          <input type="text" id="ort" name="ort" required/>
          <div class="field-error" id="err-ort"></div>
        </div>
      </div>

      <label for="country" id="lbl-country">Land</label>
      <input type="text" id="country" name="country" required/>
      <div class="field-error" id="err-country"></div>

      <label class="checkbox-line">
        <input type="checkbox" id="confirm" name="confirm" required/>
        <span id="txt-confirm">Ich bestätige, dass die angegebenen Daten korrekt sind.</span>
      </label>
      <div class="field-error" id="err-confirm"></div>

      <label class="checkbox-line">
        <input type="checkbox" id="privacy" name="privacy" required/>
        <span id="txt-privacy">Ich stimme der Verarbeitung meiner Daten gemäss DSGVO zu.</span>
      </label>
      <div class="field-error" id="err-privacy"></div>

      <div class="hint linkline">
        <a id="privacy-link" href="privacy.html?lang=de" target="_blank" rel="noopener">Datenschutzhinweise</a>
      </div>

      <button type="submit" id="btn-submit">Absenden</button>
      <div class="hint" id="hint-expiry">Hinweis: Der Bestätigungslink ist aus Sicherheitsgründen limitiert.</div>
    </form>
  </div>

  <script src="app.js" defer></script>
</body>
</html>
